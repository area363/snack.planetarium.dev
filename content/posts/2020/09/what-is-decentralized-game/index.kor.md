---
title: '나인 크로니클 출시까지의 과정 : 탈중앙 게임이란?'
date: 2020-09-24
authors: [muhun.kim]
---

안녕하세요! 2개월 동안 플라네타리움의 엔지니어링 인턴으로 일한 김무훈입니다. 저는 [나인 크로니클] 출시 직전의 베타 과정과 함께하였는데요. 탈중앙 온라인 게임을 지켜보며 특이하다고 느낀 점들을 간단하게 소개해 드립니다.

나인 크로니클은 오랫동안 CBT에 가려져 있어서 "탈중앙" 키워드 외에는 공개된 정보가 적어서 저는 아래의 사항이 궁금했습니다.

1. 정말 완전한 탈중앙화 온라인 게임인지
2. 블록체인 위의 게임은 중앙화 게임과 사용자 경험이 어떻게 다를까?

[나인 크로니클]: https://nine-chronicles.com/

## 무엇이 탈중앙화일까

탈중앙 온라인 게임인지 의문을 품기 전에 **탈중앙이 뭔지** 짚고 가야 합니다.

<abbr title="Peer to peer">P2P</abbr>, 아니면 분산화 기술이라고 한 번쯤은 들어 보셨을 수 있고, 탈중앙은 이 기술을 묶어 전통적인 서버의 역할을 게임 사용자에게 분담해두는 형태를 의미합니다.

대부분의 온라인 게임은 멀티 플레이를 위해서나, 사용자의 데이터를 저장하기 위한 중앙 서버가 있습니다. 여러 이유로 (운영사가 폐업하는 등) 서버가 운영되지 않으면 게임을 플레이할 수 없습니다. 그러나 모두가 서버를 운영하게 된다면 사용자가 남아있는 한 서비스가 종료될 걱정은 하지 않아도 됩니다.

### 블록체인 위의 온라인 게임

플라네타리움은 여러 분산화 기술 중에 블록체인에 관심을 가져 탈중앙 레퍼런스 게임 "나인 크로니클"을 만들고 있습니다. 블록체인은 여러 노드[^1]가 경쟁하여 블록을 채굴하고 다른 노드에게 빨리 전파하기 노력합니다. 여러 분기로 나누어지는 체인 네트워크를 하나로 수렴하기 위한 방법인데요. 나인 크로니클은 게임 내 재화뿐만 아니라 게임 플레이 데이터도 게임 클라이언트가 다른 노드에 전파하기 위해 노력하는 체계를 갖고 있습니다.

이 과정에서 블록체인 네트워크의 초기에 일어나는 깊은 재구성 현상을 게임 커뮤니티에서 자주 목격했습니다. 게이머에게 미치는 영향은 과거에 플레이했던 시간, 레벨, 아이템 정보가 전파에 실패해서 사라지게 됩니다. 이는 어쩔 수 없이 블록체인 네트워크의 초기에 주로 발생하는 현상입니다.

[^1]: 블록체인 네트워크에 참여하는 컴퓨터를 의미합니다.

### <abbr title="reorganization">재구성</abbr> 현상

"재구성 현상"이란 주류 블록체인이 특정 분기점에 갈라진 체인으로 교체가 되는 현상입니다. 쉽게 말하자면 특정 분기점에 갈라진 블록체인이 다시 하나로 통합되는 일인데요. 블록체인 커뮤니티에서는 리오그<sup>reorg</sup>라 줄여서 부릅니다. 이 글에서도 편의상 리오그라 칭하겠습니다.

{{<
figure
  src="images/single-chain.png"
  caption="블록을 연결하는 체인은 단 하나다"
>}}

리오그 현상에 대해 설명하기 전에 하나의 노드에서 블록체인의 분기는 단 하나라는 사실을 알아두셔야 됩니다.

블록체인의 블록은 누구나 생성할 수 있습니다. 그러나 여러 노드가 같은 시점에 블록을 동시에 만든다면 체인이 여러 개로 분리되기 마련입니다. 그러면 어떻게 하나의 체인을 유지할 수 있는 걸까요?

{{<
figure
  src="images/orphaned-block.png"
  caption="비슷한 시점에 더 많은 블록을 이은 체인을 선택한다."
>}}

답은 간단합니다. 비슷한 시점에 블록을 생성하는데 더 많은 자원이 투자된 체인을 채택합니다. 위 사진에서는 블록 두 개의 차이를 두고 파란 블록의 체인이 채택이 되었습니다.

{{<
figure
  src="images/orphaned-blocks.png"
  caption="5개의 길이를 가진 빨간 블록의 체인이 파란 블록으로 리오그된다"
>}}

보통의 경우 블록 한두 개를 두고 얕은 리오그가 일어나지만 나누어진 블록의 깊이가 일정 개수보다 많다면 깊은 리오그가 일어납니다. 예를 들어,

1. A, B 분기로 체인이 나뉘어져 다른 노드로 전파된다.
2. 비슷한 비율로 점차 전파되는 노드가 늘어가며 체인의 길이도 늘어간다.
3. 모든 노드가 A 분기와 B 분기 중 하나를 채택했고, A 분기의 체인이 더 길고 채택된 비율이 높다.
4. B 분기의 체인을 채택한 모든 노드의 체인이 A로 리오그 됩니다.

나인 크로니클 같은 탈중앙 게임으로 소개를 드리면, 한 플레이어가 특정 전투를 통과했으나, 나중에는 통과하지 못한 것으로 변하는 현상이 하나의 예시입니다.

{{<
figure
  src="images/bug-report.png"
  caption="어제 10,000 골드를 보유했던 사용자가 1,000 미만의 골드를 보유하게 되었다고 제보를 했다."
>}}

그래서 리오그 현상 때문에 시간, 레벨, 아이템을 잃었다는 이야기가 나인 크로니클 커뮤니티에서 자주 언급되었습니다. 탈중앙 네트워크에서 발생한 일이기 때문에 운영진에게 되돌려달라고 할 수도 없는 노릇입니다. 엔지니어링 팀 내부에서는 플레이했던 기록이 꿈처럼 되어 버린다고 해서 <q>신기루</q> 현상이라고 부릅니다.

### 블록체인 네트워크 초기화

나인 크로니클은 베타 기간 동안 체인 네트워크를 일곱 번 초기화했습니다. 체인 네트워크가 초기화되면 게임 플레이어가 일구었던 게임 데이터가 모두 사라지게 됩니다. 이런 위험을 감수하고도 초기화를 감행한 이유는 다음과 같습니다.

블록체인 네트워크 코어 [Libplanet]에서는 게임의 상태를 블록에 저장합니다. 사용자의 행동은 경우 Action이라는 이름의 자료 구조에 맞추어 저장됩니다.

```json
{
  "stageId": "123",
  "id": "ntPSdIREOUOARaRYJHlGEg==",
  "equipments": ["KTm6cLkrtEWs6k4A821K3Q=="],
  "avatarAddress": "sGo0bo0VwrYA7ubq6yV8ctiU2vc=",
  "foods": [],
  "worldId": "3"
}
```

만약 게임 내에서 의상 요소가 업데이트된다면 `costumes` 같이 새로운 속성이 추가되고, 이 정보가 담긴 블록의 해시가 이전 블록의 해시를 만드는 규약과 맞지 않게 됩니다. 프로토콜이 달라지면 이전의 블록체인 데이터를 이어서 사용할 수 없게 됩니다. 이 외에도 유니크한 값이 다르게 되거나, Libplanet이나 그 SDK의 코드 중에 해시에 영향이 가는 수정이 생긴다면 달라집니다.

그런 이유로 비공개 베타 기간 나인 크로니클은, 큰 업데이트가 있을 때마다 체인을 초기화할 수밖에 없었습니다. 하지만 이를 해결하기 위해서 여러 제안들이 검토된 상황으로, 기회가 된다면 이후에 스낵에서 이를 소개할 예정이라고 합니다.

[libplanet]: https://libplanet.io

### 직관적인 탈중앙 경험

플라네타리움의 전사 3분기 목표는 <q>혁신을 타협하지 않은 탈중앙 레퍼런스 게임을 만들자!</q>입니다. 나인 크로니클은 개인키를 비밀번호와 함께 사용자가 관리하는 인증 체계를 갖고 있습니다. 저는 중앙화 서버에 익숙한 게이머의 멘탈 모델로는 개인키를 별도로 보관하기 불편할 법하다고 느꼈습니다. 그래서 암호화폐 거래소처럼 외부에 키를 맡길 수 있는 기능이 있으면 어떨까 엔지니어링 워크숍에서 의견을 꺼냈지만, 편리성을 위해 사용자의 자산을 외부에 맞기는 것은 탈중앙 게임의 좋은 레퍼런스가 아니게 된다는 의견을 받았습니다.

그러나 원칙적으로 중앙화의 요소는 아니되, 분명 우리에게 익숙한 인지적 요소를 첨가하면 탈중앙 사용자 경험의 개선 여지는 있다고 생각했습니다. 가령 론처에서 처음 연결할 노드가 설정되지 않았다면 <abbr title="no peer was given">"피어가 주어지지 않았습니다."</abbr> 라고 피어라는 용어[^2]를 바탕으로 만든 문구가 있습니다. 그보다는 <abbr title="seed">시드</abbr> 라는 개념이 게이머들에게 더 익숙해서 <abbr title="no seed nodes were configured">"시드 노드가 설정되지 않았습니다"</abbr>로 수정하는 게 더 자연스러워 보였습니다.

[^2]: 블록체인의 노드를 가리킵니다. 사용자가 노드를 이용하는 관점에서 피어를, 전체 네트워크에서 한 요소라고 강조할 때는 노드를 사용합니다.

## 마치며

플라네타리움은 "커뮤니티가 운영하는 온라인 게임"이라는 매력을 통해 새로운 형태의 게임 문화를 정착시키는 것에 큰 기대를 하고 있습니다. 간혹 온라인 게임의 운영사 직원이 게임의 자원을 횡령하여 게임의 생태계를 무너뜨리는 일이 언론에 보도되는데요. 나인 크로니클은 게임의 규칙이 프로토콜 수준으로 투명해져서 그런 일이 원칙적으로 일어날 수 없습니다.

하자만 Libplanet이 사용하는 블록체인 프로토콜이 진입 장벽으로 느껴질 수 있습니다. 라인 단위로 분산하고 자동으로 병합이 되는 Git을 처음 보고 느낀 충격이랄까요. 그래서 여러분이 게임을 플레이하면 겪는 아쉬움, 개선점을 [디스코드 채널](https://discord.gg/planetarium)과 GitHub[^3]에서 받고 있습니다!

[^3]: 나인 크로니클을 위한 Libplanet 기반의 SDK : [Lib9c](https://github.com/planetarium/lib9c), 게임 클라이언트 전용의 블록체인 노드 서비스 [NineChronicles.Standalone](https://github.com/planetarium/ninechronicles.standalone), [libplanet](https://github.com/planetarium/libplanet)
